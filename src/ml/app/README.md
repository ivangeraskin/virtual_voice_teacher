# –ó–∞–ø—É—Å–∫ ml

1. –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–∫–∞—á–∞—Ç—å –º–æ–¥–µ–ª—å (–≤—ã–ø–æ–ª–Ω—è—Ç—å –∏–∑ –ø–∞–ø–∫–∏ `/app`)
```
./load_data.sh
```
–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

![](../../../notebooks/uo_1/img/Screenshot from 2022-11-30 16-40-50.png)

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `ffmpeg` –∏ –¥–æ–ø–∫–æ–¥–µ–∫–∏
```
apt-get install ffmpeg libavcodec-extra
```
3. –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
 - `python api.py` - –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å, –ø–æ–ª—É—á–∞–µ—Ç mp3_raw_data, –Ω–∞ –≤—ã—Ö–æ–¥–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
 - `python process_audio.py` - –≤—ã–ø–æ–ª–Ω–∏—Ç –ø–∞—Ä–æ—á–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –º–æ–¥–µ–ª–∏

4. –§—É–Ω—Ü–∏—è `process` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

```python
def process(file_pth: str) -> Dict:
    mp3_raw_data = prepare_audio_file(audio_file_path=file_pth)

    response = requests.post("http://localhost:8080/recognize", data=mp3_raw_data)
    response.raise_for_status()
    recognized_text = response.json().get('recognized_text')

    text_for_ml = add_punctuation_to_recognize_text(recognized_text=recognized_text)
    text_for_user = filler_word_analyse(text=text_for_ml, filler_words=FILLER_WORLDS)
    return {"message": text_for_user}
```


–ß—Ç–æ –Ω–∞–π–¥–µ–Ω–æ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
- –º–æ–¥–µ–ª—å VOSK –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–ª–≥–æ, –ø–æ —ç—Ç–æ–π –ø—Ä–∏—á–∏–Ω–µ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∏ –µ—â–µ –æ—Ç–∂–∏—Ä–∞–µ—Ç –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ, —É –º–µ–Ω—è –æ–∫–æ–ª–æ 10–ì–ë.
- –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã –æ—Ç —Ç–µ–ª–µ–≥—Ä–∞–º–∞ `*.wav` –Ω–µ —á–∏—Ç–∞—é—Ç—Å—è `pydub/AudioSegment.from_file` (–æ—à–∏–±–æ–∫ –Ω–µ—Ç, –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø—É—Å—Ç–æ—Ç–∞)
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç `format="wav"` –≤—ã–ª–µ—Ç–∞–µ—Ç –æ—à–∏–±–∫–∞ `ffmpeg` (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–∫–æ–¥–µ–∫–æ–≤ –ø—Ä–æ–±–ª–µ–º—É –Ω–µ —Ä–µ—à–∞—é—Ç).
–ü–æ —ç—Ç–æ–π –ø—Ä–∏—á–∏–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∫—É—Å–æ–∫:
```python
    if audio_file_path.split(".")[-1] == 'wav':
        #TODO –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —Ç–∫ *.wav —Ñ–∞–π–ª—ã –æ—Ç —Ç–µ–ª–µ–≥—Ä–∞–º–∞ –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é, –≤—ã–¥–∞—é—Ç –ø—É—Å—Ç–æ—Ç—É
        # –Ω–∏–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏—Ö –ø–µ—Ä–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ mp3
        mp3.export(audio_file_path.replace('.wav', '.mp3'), format="mp3")
        mp3 = AudioSegment.from_file(audio_file_path.replace('.wav', '.mp3'))
```
–í–æ–æ–±—â–µ —ç—Ç–æ—Ç `.wav` - —ç—Ç–æ `.ogg` –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –Ω–æ –∏ —É–∫–∞–∑–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π `sudo apt install vorbis-tools` - –Ω–µ –ø–æ–º–æ–≥–∞–µ—Çü§∑‚Äç‚ôÇÔ∏è
- –ª–æ–≥ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ –¥–æ—Å—Ç—É–ø–µ–Ω —Ç—É—Ç `src/ml/app/logs/output.logs` - –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ 1 —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç –ø–æ—Ä—è–¥–∫–∞ 10 —Å–µ–∫ (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ–Ω —Ä–∞–≤–µ–Ω –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è)